grammar Footprinter;


NAME: [a-zA-Z_][a-zA-Z0-9_]* ;
IP: [0-9]+ '.' [0-9]+ '.' [0-9]+ '.' [0-9]+ ;

SPACE: [ \t\r\n]+ -> skip ;
COMMENT: '#' ~[\r\n]* -> skip ;


program
    : statement* EOF
    ;

statement
    : assignStmt ';'
    | funcCallStmt ';'
    | forStmt
    | caseStmt
    | block
    ;

// host: 127.0.0.1;
assignStmt
    : NAME ':' (IP | functionCall) 
    ;

// scan_tcp(host);
funcCallStmt
    : functionCall
    ;

functionCall
    : NAME '(' funcArgs ')'
    ;

funcArgs
    : (NAME | IP) (',' (NAME | IP))*
    ;

// for open in tcp { ... }
forStmt
    : 'for' NAME 'in' NAME block
    ;

// case web { ... }
caseStmt
    : 'case' NAME block
    ;

block
    : '{' statement* '}'
    ;